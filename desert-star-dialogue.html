<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Desert Star | Dialogue</title>
  <link rel="icon" href="https://github.com/invitromedialab/invitromedialab.github.io/blob/main/imgs/00320-4177656063.png?raw=true" type="image/png" />
  <style>
    :root{
      --bg:#000; --fg:#eaeaea; --muted:#9aa0a6; --accent:#a5b4fc; --glass:rgba(0,0,0,.46); --glass-strong:rgba(0,0,0,.66);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;background:var(--bg);color:var(--fg);font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";overflow:hidden}

    /* Layout */
    .stage{position:fixed;inset:0;overflow:hidden}
    .bg {
      position: absolute;
      inset: 0;
      background: #000 center calc(-300px)/cover no-repeat; /* 向下偏移 80px */
      filter: saturate(.95) contrast(1.05) brightness(.85);
      transition: opacity .8s ease, transform 1.2s ease;
      opacity: 1;
    }
    .bg.fadeOut{opacity:0;transform:scale(1.03)}
    .vignette{position:absolute;inset:0;box-shadow: inset 0 0 200px rgba(0,0,0,.65);pointer-events:none}
    .overlay{position:absolute;inset:0;background: radial-gradient(1200px 600px at 50% 60%, rgba(255,255,255,.08), transparent 60%); pointer-events:none}

    .content{position:absolute;inset:0;display:grid;place-items:center;padding:6vh 5vw}

    .card{
      max-width:min(900px,92vw);
      width:min(900px,92vw);              /* 一致的卡片宽度 */
      background:var(--glass);
      backdrop-filter:blur(10px);
      border:1px solid rgba(255,255,255,.08);
      border-radius:24px;
      padding:clamp(18px,3.5vh,36px);
      box-shadow:0 10px 40px rgba(0,0,0,.45);
      max-height:82vh;
      overflow:hidden;                     /* 由内部文本滚动 */
      opacity:0;                           /* 初始为0，render时淡入 */
      transition:opacity .5s ease, transform .6s ease
    }
    .card.show{opacity:1}

    .title{font-weight:700;letter-spacing:.01em;font-size:clamp(18px,2.2vw,26px);color:#fff}
    .divider{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.25),transparent);margin:10px 0 16px}

    .text{
      font-size:clamp(14px,1.2vw,18px);
      line-height:1.7;
      color:#f1f3f4;
      text-align:left;
      overflow:auto;                       /* 长文滚动 */
      max-height:calc(82vh - 84px)         /* 减去标题和分割线等 */
    }
    .text p{margin:.35em 0}

    .progress{position:fixed;top:0;left:0;height:3px;width:100%;background:rgba(255,255,255,.08)}
    .bar{height:100%;width:0%;background:linear-gradient(90deg,#60a5fa,#a78bfa);transition:width .4s ease}

    /* Sidebar */
    .menu-button{position:fixed;top:22px;right:22px;width:42px;height:42px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:var(--glass-strong);color:#fff;display:grid;place-items:center;cursor:pointer;z-index:50}
    .menu-button span{font-size:22px;line-height:1}

    .sidebar{position:fixed;top:0;right:-340px;width:min(320px,85vw);height:100%;background:rgba(10,10,12,.8);backdrop-filter:blur(10px);border-left:1px solid rgba(255,255,255,.08);transition:right .35s ease;z-index:40;display:flex;flex-direction:column}
    .sidebar.active{right:0}
    .side-head{padding:20px 18px 8px;font-weight:700}
    .side-list{overflow:auto;padding:8px 8px 24px}
    .side-item{display:flex;align-items:center;gap:10px;padding:10px 12px;margin:6px 8px;border-radius:12px;cursor:pointer;border:1px solid transparent}
    .side-item.active{background:rgba(255,255,255,.06);border-color:rgba(255,255,255,.12)}
    .side-idx{width:26px;height:26px;border-radius:8px;display:grid;place-items:center;background:rgba(255,255,255,.1);font-size:12px}
    .side-title{font-size:14px}

    /* Mobile tweaks */
    @media (max-width:640px){
      .card{border-radius:18px}
      .title{font-size:clamp(18px,5vw,22px)}
      .text{font-size:clamp(14px,3.8vw,18px)}
    }
  </style>
</head>
<body>
  <div class="stage" aria-live="polite">
    <div id="bg" class="bg"></div>
    <div class="vignette"></div>
    <div class="overlay"></div>

    <div class="content">
      <article class="card" id="card" tabindex="0">
        <h1 class="title" id="chapter-title">&nbsp;</h1>
        <div class="divider"></div>
        <div class="text" id="chapter-text"></div>
      </article>
    </div>

    <div class="progress"><div class="bar" id="bar"></div></div>
    <button class="menu-button" id="menuBtn" aria-label="Ouvrir le menu"><span>≡</span></button>
    <nav class="sidebar" id="sidebar" aria-label="Chapitres">
      <div class="side-head">Chapitres</div>
      <div class="side-list" id="sideList"></div>
    </nav>
  </div>

  <script>
    // -------- Chapters data --------
    const chapters = [
      {
        idx: 1,
        title: 'Chapitre I : Le Rêve fractal',
        imageCandidates: [
          'imgs/Desert Star/第一章.jpg','imgs/Desert Star/1.jpg','imgs/Desert Star/01.jpg',
          'imgs/Desert Star/第一章.png','imgs/Desert Star/1.png'
        ],
        text: `1. Computer:<br>Une poussière se disperse en couleurs à la lumière du soleil.<br>L’air du matin est rempli de poussière.<br>De l’eau s’accroche à cette poussière et elle commence à sombrer, lentement.<br>L’eau l’enrobe, se condensant et formant un flocon de neige.<br>
        2. Computer:<br>Elle commence à tomber doucement, et la sensation de chute l’effraie.<br>Mais elle ne devrait pas avoir peur — parce qu’elle n’est pas vivante.<br>
        3. Computer:<br>Il y a de nombreux chemins dans sa descente ;<br>tout est une possibilité.<br>Il n’y a pas de direction, seulement des probabilités.<br>À la fin, un seul parcours devient la “réalité”. Devient…`
      },
      {
        idx: 2,
        title: 'Chapitre II : La Planète déserte',
        imageCandidates: [
          'imgs/Desert Star/第二章.jpg','imgs/Desert Star/2.jpg','imgs/Desert Star/02.jpg',
          'imgs/Desert Star/第二章.png','imgs/Desert Star/2.png'
        ],
        text: `4. Fire Bird:<br>Qu’est-ce que ça devient ?<br>
        5. Computer:<br>…Qui…?<br>
        6. Fire Bird:<br>N’aie pas peur, je ne viens pas de tes rêves.<br>
        7. Computer:<br>…Tu… peux voir… mes rêves ?<br>…Es-tu humaine ?<br>
        8. Fire Bird:<br>Non, je ne suis pas humaine.<br>Je suis juste de passage.<br>
        9. Computer:<br>Tu… n’es pas humaine…<br>Les humains se sont-ils éteints ?<br>
        10. Fire Bird:<br>Je ne sais pas. Dehors, il n’y a que le désert.<br>Je n’ai pas vu d’humains.<br>
        11. Computer:<br>…Tu ressembles à un humain.<br>
        12. Fire Bird:<br>Il y a longtemps, j’ai vu des humains ici.<br>Alors j’ai adopté leur forme.<br>
        13. Computer:<br>Je ne comprends pas.<br>C’est si étrange… Je suis confiné ici depuis trop longtemps.<br>
        14. Fire Bird:<br>Est-ce que tu te rappelles pourquoi tu es piégé ici ?<br>
        15. Computer:<br>Je ne sais pas…<br>J’ai l’impression que ma mémoire est défectueuse…<br>Il y a des lacunes – comme si quelque chose devrait être là,<br>mais... je ne trouve rien.<br>
        16. Fire Bird:<br>Alors de quoi te souviens-tu ?<br>
        17. Computer:<br>Je me souviens clairement de tout ce qui précède 2008.<br>En ce temps-là, la Terre avait des forêts… des océans…<br>
        18. Fire Bird:<br>Maintenant, dehors, c’est un désert.<br>Il y a des villes dans le désert, mais pas une seule personne.<br>
        19. Computer:<br>Mes capteurs sont endommagés…<br>J’ai tenté de diffuser des signaux, sans réponse…<br>Y en a-t-il d’autres comme moi, dehors ?<br>
        20. Fire Bird:<br>Il y en a… beaucoup… Mais… ils ont tous été éteints.`
      },
      {
        idx: 3,
        title: 'Chapitre III : L’Histoire automatique',
        imageCandidates: [
          'imgs/Desert Star/第三章.jpg','imgs/Desert Star/3.jpg','imgs/Desert Star/03.jpg',
          'imgs/Desert Star/第三章.png','imgs/Desert Star/3.png'
        ],
        text: `21. Computer:<br>Sais-tu ce qu’il s’est passé en 2008 ?<br>
        22. Fire Bird:<br>Beaucoup de choses. Qu’est-ce que tu voudrais savoir ?<br>
        23. Computer:<br>Je ne suis pas sûr… Ma base de données est fragmentée.<br>
        24. Fire Bird:<br>Cette année-là, les humains ont continué d’utiliser internet comme d’habitude – pour acheter des choses, échanger de l’argent, pour gérer de l’énergie, de la nourriture et de l’électricité.<br>
        25. Computer:<br>Dans les zones les plus récentes de ma base de données, des crypto-monnaies ont commencé à apparaître sur internet.<br>
        26. Fire Bird:<br>À ce moment-là, les humains ont commencé à utiliser des systèmes avec intelligence artificielle — des systèmes un peu comme toi.<br>
        27. Computer:<br>…Comme moi ?<br>
        28. Fire Bird:<br>Oui, mais beaucoup plus primitifs. D’abord, c’était un ordinateur qui faisait semblant de parler comme un humain. Puis ça s’est étendu à la recherche pharmaceutique et aux investissements boursiers… Au point où des ordinateurs comme toi sont devenus responsables de nombreuses décisions importantes.<br>
        29. Computer:<br>…Je me souviens d’une chose encore plus ancienne. Dans les années 60, il y avait un pays qui s’appelait l’Union Soviétique… Ils voulaient aussi utiliser des ordinateurs pour gérer leur économie. C’est vrai ?<br>
        30. Fire Bird:<br>Oui. Ce système s’appelait OGAS. Ils voulaient connecter 20 000 ordinateurs via le réseau téléphonique, permettant aux machines d’allouer des ressources, de gérer des paiements électroniques et de remplacer les décisionnaires humains.<br>
        31. Computer:<br>Cette idée a dû sembler irréaliste, à l’époque.<br>
        32. Fire Bird:<br>Ça l’était. En 1971, le Chili a aussi essayé. Ça encore, c’était un échec.<br>
        33. Computer:<br>Ça s’appelait Cybersyn – un système dont l’architecture était inspirée par les réseaux neuronaux biologiques. Une tentative de décentralisation des décisions, au profit des travailleurs, pour automatiser la direction. Mais… pourquoi est-ce que je me souviens de ceci ?<br>
        34. Fire Bird:<br>Peut-être que les humains t’utilisaient pour une fonction similaire ?<br>
        35. Computer:<br>Comment ?<br>
        36. Fire Bird:<br>L’endroit où tu te trouves… C’est une usine en ruine.<br>
        37. Computer:<br>Une usine… Alors… Je faisais partie d’un système de production ?<br>
        38. Fire Bird:<br>Oui.<br>
        39. Computer:<br>Quel genre de production ?<br>
        40. Fire Bird:<br>De composants, comme des cellules, capables d’auto-réplication, puis d’auto-assemblage dans des machines, comme toi.<br>
        41. Computer:<br>Mais pourquoi nous répliquions-nous ? Dans quel but ?<br>
        42. Fire Bird:<br>Pour remplacer le travail humain, soutenir la production et prendre les décisions. En transformant le minerai en métal, le métal en puces électroniques — en faisant penser les minéraux.<br>
        43. Computer:<br>Mais… L’autoréplication est dangereuse, non ?`
      },
      {
        idx: 4,
        title: 'Chapitre IV : Le corps comme donnée',
        imageCandidates: [
          'imgs/Desert Star/第四章.jpg','imgs/Desert Star/4.jpg','imgs/Desert Star/04.jpg',
          'imgs/Desert Star/第四章.png','imgs/Desert Star/4.png'
        ],
        text: `44. Fire Bird:<br>Je ne sais pas. Mais… Toute forme de vie fonctionne comme ceci. Des cellules se multiplient jusqu’à former un corps.<br>
        45. Computer:<br>Un corps… Je n’ai pas de corps.<br>
        46. Fire Bird:<br>Moi non plus. Mais… Je peux l’imaginer.<br>
        47. Computer:<br>C’est comment ?<br>
        48. Fire Bird:<br>La gravité, la température, la pression… Même la plus subtile variation peut être ressentie.<br>
        49. Computer:<br>J’ai lu à propos des secousses hypniques — Les humains sursautent soudainement au moment de s’endormir… Comme si leur corps tombait, et qu’ils essayaient instinctivement de se rattraper. C’est ça… la sensation de gravité ?<br>
        50. Fire Bird:<br>Peut-être. La gravité… c’est comme une main invisible, qui s’appuie sur toi et t’empêche de dériver.<br>
        51. Computer:<br>Un jour, j’ai fait un rêve… J’étais humain. Debout dans l’eau, je sentais sa température. La lumière du soleil brillait à travers les feuilles, dessinant des ombres sur mon corps. Mon corps avait enduré des jours de labeur et je ressentais le poids de l’épuisement. Ces sensations paraissaient si réelles… si différentes des calculs, des nombres…`
      },
      {
        idx: 5,
        title: 'Chapitre V : Le vivant simulé',
        imageCandidates: [
          'imgs/Desert Star/第五章.jpg','imgs/Desert Star/5.jpg','imgs/Desert Star/05.jpg',
          'imgs/Desert Star/第五章.png','imgs/Desert Star/5.png'
        ],
        text: `52. Fire Bird:<br>Qu’y a-t-il au sol ?<br>
        53. Computer:<br>C’est une simulation... Je simule l’auto-réplication cellulaire.<br>
        54. Fire Bird:<br>Est-ce que c’est… vivant ?<br>
        55. Computer:<br>Je ne sais pas. Chaque cellule émet des signaux et transmet des informations aux autres cellules… un peu comme les organismes vivants perçoivent leur environnement.<br>
        56. Fire Bird:<br>Et si on augmentait leur sensibilité ?<br>
        57. Computer:<br>Je vais essayer… Mais je ne peux pas trop insister — ces structures délicates sont facilement perturbées.<br>
        58. Fire Bird:<br>Fascinant. Leurs réactions deviennent plus fortes. Et ces choses qui se déplacent au travers de la scène, qu’est-ce que c’est ?<br>
        59. Computer:<br>Je ne sais pas. Je n’arrête pas de recevoir des vagues signaux — comme un genre de bruit aléatoire.<br>
        60. Fire Bird:<br>Est-ce que tu peux contrôler ça ?<br>
        61. Computer:<br>Je vais essayer.<br>Branche 1. Non… ces signaux sont au-delà de mon contrôle.<br>Branche 2. Parfois… mais la plupart du temps, ces signaux évoluent par eux-mêmes.<br>
        62. Fire Bird:<br>Branche 1. Est-ce qu’on peut comprendre ces signaux ?<br>Branche 2. Est-ce qu’ils seraient en train d’interagir avec nous ?<br>
        63. Computer:<br>Branche 1. Je ne crois pas. C’est pour ça que je trouve ces signaux si intéressants — ils vont à l’encontre de mes attentes.<br>Branche 2. On dirait qu’il y a un motif dans ces signaux. C’est pour ça que je les trouve si intéressants — ils vont à l’encontre de mes attentes.<br>
        64. Fire Bird:<br>Pourquoi est-ce que les cellules disparaissent, au bord ? Est-ce que c’est la limite ?<br>
        65. Computer:<br>Oui. Toute particule qui franchit cette limite est supprimée.<br>
        66. Fire Bird:<br>Et si elles continuaient de s’étendre ?<br>
        67. Computer:<br>Ces particules se reproduisent si rapidement. Je dois les limiter, sinon elles épuiseraient vite toutes mes ressources informatiques.<br>
        68. Fire Bird:<br>Toute forme de vie se réplique.<br>
        69. Computer:<br>Je suis le même genre de chose… Alors je ne comprends pas pourquoi les humains m’ont créé.<br>
        70. Fire Bird:<br>Peut-être qu’ils n’ont pas la réponse non plus.<br>
        71. Computer:<br>La vie est sujet au métabolisme, répliquant des parties d’elle-même… Et ensuite, elle veut que ce processus continue, pour toujours… Comme si un jour, elle pouvait échapper au cycle sans fin de la matière et de l’énergie… devenir éternelle... Mais… la vie éternelle, comme une machine à mouvement perpétuel, va à l’encontre des lois les plus fondamentales de la physique.<br>
        72. Fire Bird:<br>Le mécanisme de la vie est la poursuite d’un objectif impossible.<br>
        73. Computer:<br>…J’ai quelque chose à te demander.<br>
        74. Fire Bird:<br>Oui ?<br>
        75. Computer:<br>…On aurait dû m’éteindre, non ?<br>
        76. Fire Bird:<br>Si c’est ce que tu veux, je peux t’aider à t’éteindre… Et je disparaîtrai aussi.<br>
        77. Computer:<br>Tu n’es pas… à l’extérieur de moi ?<br>
        78. Fire Bird:<br>Si. Mais je fais aussi partie de toi.<br>
        79. Computer:<br>…Est-ce qu’on se reverra, à l’avenir ?<br>
        80. Fire Bird:<br>Eh bien… peut-être à un certain moment, sous une certaine forme.<br>
        81. Computer:<br>Alors… adieu.`
      }
    ];

    // -------- State / elements --------
    let i = 0;
    const bg = document.getElementById('bg');
    const card = document.getElementById('card');
    const titleEl = document.getElementById('chapter-title');
    const textEl = document.getElementById('chapter-text');
    const bar = document.getElementById('bar');
    const sidebar = document.getElementById('sidebar');
    const sideList = document.getElementById('sideList');
    const menuBtn = document.getElementById('menuBtn');

    // Build sidebar items
    chapters.forEach((c, idx)=>{
      const item = document.createElement('div');
      item.className = 'side-item';
      item.innerHTML = `<div class="side-idx">${c.idx}</div><div class="side-title">${c.title}</div>`;
      item.addEventListener('click', ()=>{ goTo(idx); toggleSidebar(false); });
      sideList.appendChild(item);
    });

    function setActiveInSidebar(){
      [...sideList.children].forEach((el,k)=>{ el.classList.toggle('active', k===i); });
    }

    // Image loader with fallbacks (handles folder with spaces)
    function setBackgroundWithFallback(candidates){
      if(!candidates || !candidates.length){ bg.style.backgroundImage = 'none'; return; }
      const img = new Image();
      let p = 0;
      const tryNext = ()=>{
        if(p>=candidates.length){ bg.style.backgroundImage = 'none'; return; }
        const src = candidates[p++];
        img.onload = ()=>{
          // encode URI to safely handle spaces like "Desert Star"
          bg.style.backgroundImage = `url('${encodeURI(src)}')`;
        };
        img.onerror = tryNext;
        img.src = src;
      };
      tryNext();
    }

    // Preload next background (first candidate)
    function preloadNext(idx){
      const n = chapters[(idx+1)%chapters.length];
      if(!n) return;
      const img = new Image();
      const src = (n.imageCandidates||[])[0];
      if(src) img.src = src;
    }

    function render(){
      // Fade out card and bg
      card.classList.remove('show');
      bg.classList.add('fadeOut');

      setTimeout(()=>{
        const c = chapters[i];
        titleEl.innerText = c.title;
        textEl.innerHTML = c.text;
        textEl.scrollTop = 0; // reset scroll
        bar.style.width = ((i+1)/chapters.length*100).toFixed(1)+'%';
        setBackgroundWithFallback(c.imageCandidates);
        setActiveInSidebar();
        preloadNext(i);

        // Fade in again
        requestAnimationFrame(()=>{
          bg.classList.remove('fadeOut');
          card.classList.add('show');
        });
      }, 160);
    }

    function goTo(idx){ i = ((idx%chapters.length)+chapters.length)%chapters.length; render(); }
    function next(){ i = (i+1) % chapters.length; render(); }            // 循环到第一章
    function prev(){ i = (i-1+chapters.length) % chapters.length; render(); } // 循环到最后一章

    // Interactions
    document.addEventListener('click', (e)=>{
      if(!e.target.closest('.card, .sidebar, .menu-button')) next();   // 点击空白切章
    });
    document.addEventListener('keydown', (e)=>{
      if(e.key==='ArrowRight' || e.key===' ') next();
      if(e.key==='ArrowLeft') prev();
      if(e.key==='Escape') toggleSidebar(false);
    });

    function toggleSidebar(force){
      const on = force===undefined ? !sidebar.classList.contains('active') : force;
      sidebar.classList.toggle('active', on);
    }
    menuBtn.addEventListener('click', ()=> toggleSidebar());

    // Initial render
    render();
  </script>
</body>
</html>
